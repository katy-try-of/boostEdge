<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Carrito ‚Äì BoostEdge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#F4F6F8] text-slate-900">

  <!-- NAVBAR -->
  <header class="bg-white shadow-sm mb-10">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16">

      <!-- LOGO -->
      <a href="index.html" class="flex items-center gap-2">
        <img src="imagenes/logo.png" alt="BoostEdge Logo" class="h-16 w-auto">
      </a>

      <!-- MENU -->
      <nav class="hidden md:flex gap-8 text-sm font-medium text-slate-600">
        <a href="index.html#one" class="hover:text-[#1FB6FF]">Productos</a>
        <a href="index.html#por-que" class="hover:text-[#1FB6FF]">Por qu√© BoostEdge</a>
        <a href="blog.html" class="hover:text-[#1FB6FF]">Blog</a>
      </nav>

      <!-- ICONO CARRITO -->
      <a href="carrito.html" class="relative">
        <img src="imagenes/carrito.png" class="w-11 h-11">
        <span id="cart-count" class="absolute -top-2 -right-2 bg-[#1FB6FF] text-white text-xs rounded-full px-2 py-0.5">
          0
        </span>
      </a>

    </div>
  </header>



  <main class="max-w-4xl mx-auto p-6">

    <h1 class="text-3xl font-bold text-[#0F2D47] mb-6">Tu carrito</h1>

    <!-- CONTENEDOR DEL CARRITO -->
    <div id="cart-items" class="space-y-4"></div>

    <!-- RESUMEN -->
    <div id="cart-summary" class="mt-10 bg-white p-6 rounded-2xl shadow hidden">
      <h2 class="text-xl font-semibold mb-4">Resumen</h2>

      <div class="flex justify-between text-sm mb-2">
        <span>Subtotal</span>
        <span id="subtotal">0 ‚Ç¨</span>
      </div>

      <div class="flex justify-between text-sm mb-2">
        <span>IVA (21%)</span>
        <span id="iva">0 ‚Ç¨</span>
      </div>

      <div class="border-t my-3"></div>

      <div class="flex justify-between text-lg font-bold">
        <span>Total</span>
        <span id="total">0 ‚Ç¨</span>
      </div>

      <button onclick="comprar()"
        class="w-full mt-6 py-3 bg-[#1FB6FF] text-white rounded-full font-semibold hover:bg-[#0A73B8] transition">
        Comprar ahora
      </button>
    </div>

  </main>



  <script>

    /* === FIX: Normalizar quantity para evitar undefined, null, NaN === */
    function fixCartData() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      cart = cart.map(item => ({
        ...item,
        quantity: (typeof item.quantity === "number" && item.quantity > 0)
          ? item.quantity
          : 1
      }));

      localStorage.setItem("cart", JSON.stringify(cart));
    }



    /* === CARGAR CARRITO === */
    function loadCart() {
      fixCartData();

      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      const list = document.getElementById("cart-items");
      const summary = document.getElementById("cart-summary");
      const badge = document.getElementById("cart-count");

      list.innerHTML = "";

      if (cart.length === 0) {
        list.innerHTML = `<p class="text-slate-600 text-center text-lg">Tu carrito est√° vac√≠o.</p>`;
        summary.classList.add("hidden");
        badge.textContent = 0;
        return;
      }

      badge.textContent = cart.reduce((acc, item) => acc + item.quantity, 0);

      cart.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "bg-white p-4 rounded-2xl shadow flex justify-between items-center";

        row.innerHTML = `
          <div>
            <p class="font-semibold text-[#0F2D47]">${item.name}</p>
            <p class="text-sm text-slate-500">${item.price} ‚Ç¨</p>
          </div>

          <div class="flex items-center gap-3">
            <button class="px-3 py-1 bg-slate-200 rounded-full" onclick="changeQty(${index}, -1)">‚àí</button>
            <span class="font-semibold">${item.quantity}</span>
            <button class="px-3 py-1 bg-slate-200 rounded-full" onclick="changeQty(${index}, 1)">+</button>

            <button class="ml-4 text-red-500 font-bold" onclick="removeItem(${index})">üóëÔ∏è</button>
          </div>
        `;

        list.appendChild(row);
      });

      summary.classList.remove("hidden");
      updateTotals();
    }



    /* === CAMBIAR CANTIDAD === */
    function changeQty(index, amount) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      cart[index].quantity = Math.max(1, cart[index].quantity + amount);

      localStorage.setItem("cart", JSON.stringify(cart));
      loadCart();
    }



    /* === ELIMINAR PRODUCTO === */
    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      loadCart();
    }



    /* === ACTUALIZAR TOTALES === */
    function updateTotals() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      let subtotal = cart.reduce((acc, item) => acc + item.price * item.quantity, 0);
      let iva = subtotal * 0.21;
      let total = subtotal + iva;

      document.getElementById("subtotal").textContent = subtotal.toFixed(2) + " ‚Ç¨";
      document.getElementById("iva").textContent = iva.toFixed(2) + " ‚Ç¨";
      document.getElementById("total").textContent = total.toFixed(2) + " ‚Ç¨";
    }


    /* === COMPRAR === */
    function comprar() {
      alert("Proceso de compra no implementado todav√≠a.");
    }

    /* === INICIAR === */
    loadCart();

  </script>

</body>
</html>
